# What is serverless ?
Serverless architecture generally describes fully managed cloud services. Abstract away the underlying infrastructure and 
billed based on the execution of your business task.

A serverless service could have all or most the characterstics:
* highly elastic and scalable
* highle available
* highly durable
* secure by default

# Function as a service (FaaS)
- Allows developers to focus on just writing pieces of code. 
- Has event-drieven integration trigger function based on event data or emit event data.
- generally multiple functions are orchestrated together to create a serverless app.
- Functions generally only run when needed.
- FaaS is only serverless if its fully-managed and scales to zero. 

![Alt FaaS](https://github.com/Bayesian4042/azure-services/blob/master/azure-functions/images/faas.png)

# Azure Functions
Azure Faas offering that allows developers to focus on writing code and not to worry about maintaining the underlying computing infrastructure.

- A trigger is the chosen event data that will cause function to execute. You can only have one trigger.

- A Function App defines the underlying compute for a collection of functions. It defines the hosting, runtime and the other global configuration

![Azure Function](https://github.com/Bayesian4042/azure-services/blob/master/azure-functions/images/azure-function.png)

# Storage Consideration
Every function app requires a storage account to operate.
Azure Functions uses the following storage types in the Storage Account:
    - Blob Storage
    - Azure Files
    - Queue Storage
    - Table Storage

# Anatomy of funtion
![Function Anatomy](https://github.com/Bayesian4042/azure-services/blob/master/azure-functions/images/function-anatomy.png)

# Authorizaton level
it determines what keys, if any, need to present on the request in order to invoke function.
The authorization level can be one of the following values:
- anonymous - no api key
- function - function specific api key
- amdin - the master key

# Azure Functions Debugging
You can enable streaming logs for Azure Functions to see near real time logging when an error occurs

There are two ways to view a stream of log files being generated by your function executions
- Built-in log streaming
    - The App Service platform lets you view a stream of yours application log files.
- Live Metrics Stream
    - When your function app is connected to Application Insights, you can view log data and other metrics in near real-time in Azure portal using Live Metric Stream.
- Log streams can be viewed both in the portal and in most local development environments. 

![Function Debugging](https://github.com/Bayesian4042/azure-services/blob/master/azure-functions/images/function-debugging.png)

# Azure Functions - Key Concepts
- Azure functions are lightweight and (can be) serverless
- Easier to write and deploy
- Fast to execute because there is no large application, startup time, initialization and other events fired before the code is executed.
- triggered when event is fixed.
- can be built, tested, and deployed in Azure portal using browser. 
- You only pay while your functions are running
- Automatically scale to meet the demand of traffic
- can scale to zero cost
- Azure functions has built in monitoring via Azure monitor
- Azure functions has built in CI/CD via Azure DevOps (nice!)

# Use Cases
- Scheduled Task
- Reminders and Notification
- Lightweight Web API
- Sending background emails
- Running background backup tasks
- Doing backend calculations

# VS Code Extension
In order to productively work with Azure Functions, yo need Azure Functions Extension

# Runtime
An application runtime, is compute environment configured with necessary software and system configuration to run a specific type of application code. 

Azure provides runtimes for popular programmng langauages:
- .Net
- Java
- Node.js
- Powershell core
- Python

# Windows vs Linux Hosting
When you create an Azure Function App you can choose to host it on either Windows or Linux

# Templates
Azure provices function templates to get you started with common function scenarios:
- HTTP
- Timer
- Blob Storage
- Cosmos DB
- Queue Storage
- Event Grid
- Event Hub
- Service Bus Queue
- Service Bus Topics
- SendGrid - triggered by email event in third-party service SendGrid

# Functions Configuration
function configuration file called function.json
function.json file defines the functions's trigger, bindings, and other configuration settings.

![Function Config](https://github.com/Bayesian4042/azure-services/blob/master/azure-functions/images/images/function-json.png)

# Hosts Configuration
hosts.json  file contains global configs options for all functions

# Plan Services
Azure functions has 3 available of plans:
 - Consumption Plan (Serverless) - cold-starts
 - Premium Plan (Functions Premium) - Pre-warmed
 - Dedicated Plan (App Service plan) VM sharing
    - When you use App Service for other apps, your functions will run on the same plan (VMs) at no extra cost.

# Triggers and Bindings
let's you avoid hardcoding access to other services and abstracting away boilerplate code keeping your functions lean.
  - Trigger
  - Binding
    - if you function is connected to another service
    - Blob Storage, Cosmos DB, Azure SQL, Dapr, Event Grid, Event Hub, Http Webhooks, IOT Hub, Kafka, mobile apps, notificatios hub, Twilio, Sengdrid etc

    - Binding direction: In, Out or InOut

# Triggers ad Binding Scenarios
- Scenario 1:
    Every Hour you want to read new log files delivered by your application, and you need to transform the data to be ingested in your NO/SQL database that resides in CosmosDB
    - Trigger: timer because it;s a scheduled job that will run at a speicific time. 
    - The bindings will be In for blob storage and Out for cosmos DB.

# Local Settings File
local.settings.json for local development

# Functions Core Tools
Azure functions core tools lets you develop and test your functions on your local computer from the command prompt or terminal
- func init: create a new Functions project in a specific language
-     

# Custom Handlers
lighweight web servers that receive events form functions host

# Durable Functions
It is a serverless compute extension of Azure functions that allows you to write stateful functions

Patterns of durable functions:
- Function chaining: is the pattern of executing a sequence of functions in a specific order. Often the output of one function needs to be applied to the input of another function. Durable functions allows us to implement this pattern concisely in code.
![function-chaining]()

- Fan-out/fan-in: is the pattern of executing multiple functions in parallel and then waiting for them all to finish.

- Asycn HTTP API: address the problem of coordinating the state of long-running operations with external clients.
- Aggregator pattern:

# Azure Functions on Kubernetes
Azure function app can be deployed to Kubernetes cluster KEDA